<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–‡å­—æ¨£æœ¬èˆ‡ä½œå“é›†</title>
    <!-- è¼‰å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- è¼‰å…¥ Lucide Icons (ç”¨æ–¼ç¾è§€åœ–æ¨™) -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&family=Noto+Sans+TC:wght@100..900&display=swap');
        body {
            font-family: 'Noto Sans TC', 'Inter', sans-serif;
            background-color: #f7f7f9;
        }
        .sample-content {
            white-space: pre-wrap; /* ä¿ç•™æ›è¡Œå’Œç©ºæ ¼ */
        }
        /* Custom modal for alerts/prompts */
        .custom-modal {
            transition: opacity 0.3s ease-in-out;
        }
        .lucide {
            width: 1.25rem;
            height: 1.25rem;
        }
        /* æ¨¡æ…‹æ¡†å‹•ç•« */
        .modal-content-transition {
            transition: transform 0.3s ease-out;
        }
    </style>
    <!-- Firebase SDK Imports -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-auth.js";
        import { getFirestore, doc, getDoc, addDoc, setDoc, updateDoc, deleteDoc, onSnapshot, collection, query, where, getDocs, serverTimestamp, orderBy } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-firestore.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-analytics.js";

        
        // --- 1. è¨­å®šæª”èˆ‡åˆå§‹åŒ– ---
        const firebaseConfig = {
          apiKey: "AIzaSyBnQmqGZQ_94BDgmZFzOJsKDjgYq8ipI2I",
          authDomain: "hkttext.firebaseapp.com",
          projectId: "hkttext",
          storageBucket: "hkttext.firebasestorage.app",
          messagingSenderId: "501339425536",
          appId: "1:501339425536:web:f9ddbf080a002be99701e5",
          measurementId: "G-CKY8VPMJXJ"
        };

        let app, db, auth, analytics, userId = null;
        let samples = [];
        let currentCategoryFilter = 'å…¨éƒ¨';
        let activeEditId = null;

        // Profile System - Force reset to ensure "æ‰€æœ‰æ–‡æœ¬" is default
        let profiles = localStorage.getItem('hkt_profiles') ? JSON.parse(localStorage.getItem('hkt_profiles')) : ['æ‰€æœ‰æ–‡æœ¬'];
        // Ensure "æ‰€æœ‰æ–‡æœ¬" is always in the list
        if (!profiles.includes('æ‰€æœ‰æ–‡æœ¬')) {
            profiles.unshift('æ‰€æœ‰æ–‡æœ¬');
            localStorage.setItem('hkt_profiles', JSON.stringify(profiles));
        }
        let currentProfileName = localStorage.getItem('hkt_current_profile') || 'æ‰€æœ‰æ–‡æœ¬';
        // Reset to "æ‰€æœ‰æ–‡æœ¬" if the stored profile doesn't exist
        if (!profiles.includes(currentProfileName)) {
            currentProfileName = 'æ‰€æœ‰æ–‡æœ¬';
            localStorage.setItem('hkt_current_profile', currentProfileName);
        }
        let searchTerm = '';
        let allProfileListeners = [];
        const appId = 'default-app-id'; // éœ€è¦ä¿ç•™æ­¤è®Šæ•¸ä¾›ä¸‹æ–¹ä½¿ç”¨

        // åˆå§‹åŒ– Firebase
        try {
            app = initializeApp(firebaseConfig);
            analytics = getAnalytics(app);
            auth = getAuth(app);
            db = getFirestore(app);
            console.log("Firebase initialized successfully");
        } catch (error) {
            console.error("Firebase init error:", error);
            alert("Firebase åˆå§‹åŒ–å¤±æ•—: " + error.message);
        }

        
        // --- 3. èªè­‰èˆ‡ä½¿ç”¨è€…è¨­å®š (é—œéµä¿®æ”¹) ---
        
        
        const renderUserTabs = () => {
            const container = document.getElementById('user-tabs-container');
            if (!container) return;

            let html = profiles.map(p => `
                <button 
                    onclick="window.app.switchUser('${p}')"
                    class="px-4 py-2 rounded-lg text-sm font-bold transition-all duration-200 flex items-center shadow-sm ${p === currentProfileName 
                        ? 'bg-indigo-600 text-white ring-2 ring-indigo-600 ring-offset-1' 
                        : 'bg-white text-gray-600 border border-gray-200 hover:bg-gray-50'}"
                >
                    <i data-lucide="${p === 'æ‰€æœ‰æ–‡æœ¬' ? 'layers' : 'user'}" class="w-4 h-4 mr-2"></i>
                    ${p}
                </button>
            `).join('');

            html += `
                <button onclick="window.app.addUser()" class="ml-2 px-4 py-2 rounded-lg border-2 border-dashed border-gray-300 text-gray-500 hover:border-indigo-400 hover:text-indigo-600 hover:bg-indigo-50 transition-all flex items-center font-bold">
                    <i data-lucide="plus" class="w-4 h-4 mr-1"></i>
                    æ–°å¢
                </button>
            `;

            container.innerHTML = html;
            setTimeout(() => { if(window.lucide) window.lucide.createIcons(); }, 50);
        };

        const setupEventListeners = () => {
            const searchInput = document.getElementById('search-input');
            if (searchInput) {
                searchInput.addEventListener('input', (e) => {
                    searchTerm = e.target.value;
                    renderUI();
                    setupEventListeners();
                    renderUserTabs();
                });
            }
        };

        // Immediate render
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', renderUserTabs);
        } else {
            renderUserTabs();
        }
const signInAndListen = async () => {
            if (!auth) return;
            
            onAuthStateChanged(auth, (user) => {
                if (user) {
                    userId = user.uid;
                    document.getElementById('auth-status').innerHTML = `
                        <span class="hidden" id="actual-user-id">${userId}</span>
                        <span class="text-sm text-gray-500 flex items-center" title="å·²é€£æ¥ Firebase è³‡æ–™åº«">
                            <i data-lucide="database" class="lucide-icon w-4 h-4 mr-1 text-indigo-500"></i>
                            å·²é€£æ¥è³‡æ–™åº«
                        </span>
                    `;
                    lucide.createIcons();
                    
                    // ğŸš€ å„ªåŒ–é»ï¼šç«‹å³æ¸²æŸ“ UI éª¨æ¶ (åŒ…å«ç¯©é¸å™¨å’Œæ–°å¢åˆ†é¡æŒ‰éˆ•)
                    renderUI(); 

                    if (db) {
                        listenForSamples();
                    }
                } else {
                    signInAnonymously(auth).catch((error) => {
                        console.error("Sign in failed:", error);
                        showModal('èªè­‰éŒ¯èª¤', 'ç„¡æ³•ç™»å…¥: ' + error.message);
                    });
                }
            });
        };

        
        // --- 4. Firestore è³‡æ–™æ“ä½œ (ä¿æŒä¸è®Š) ---

        const getSamplesCollectionRef = (profileName) => {
            if (!userId || !db) {
                console.error("User ID or Firestore service is not set. Cannot get collection reference.");
                // ğŸš¨ å¦‚æœç¼ºå°‘ userIdï¼Œè¿”å› nullï¼ŒlistenForSamples å°‡æœƒé€€å‡º
                return null;
            }
            if (!profileName || profileName === 'æ‰€æœ‰æ–‡æœ¬') return null;
            return collection(db, `artifacts/${appId}/profiles/${profileName}/text_samples`);
        };

        const listenForSamples = () => {
            // Clear existing listeners
            allProfileListeners.forEach(unsub => unsub());
            allProfileListeners = [];

            if (currentProfileName === 'æ‰€æœ‰æ–‡æœ¬') {
                // Aggregate from all actual user profiles
                const actualProfiles = profiles.filter(p => p !== 'æ‰€æœ‰æ–‡æœ¬');

                if (actualProfiles.length === 0) {
                    samples = [];
                    renderUI();
                    return;
                }

                let aggregated = [];

                actualProfiles.forEach(profileName => {
                    const colRef = getSamplesCollectionRef(profileName);
                    if (!colRef) return;

                    const unsub = onSnapshot(colRef, (snapshot) => {
                        const profileSamples = snapshot.docs.map(doc => ({
                            id: `${profileName}__${doc.id}`,
                            originalId: doc.id,
                            profileSource: profileName,
                            ...doc.data()
                        }));

                        // Remove old samples from this profile
                        aggregated = aggregated.filter(s => s.profileSource !== profileName);
                        aggregated.push(...profileSamples);

                        samples = aggregated.sort((a, b) => (b.timestamp?.seconds || 0) - (a.timestamp?.seconds || 0));
                        renderUI();
                    });

                    allProfileListeners.push(unsub);
                });
            } else {
                // Single profile mode
                const colRef = getSamplesCollectionRef(currentProfileName);
                if (!colRef) return;

                const unsub = onSnapshot(colRef, (snapshot) => {
                    samples = snapshot.docs.map(doc => ({
                        id: doc.id,
                        profileSource: currentProfileName,
                        ...doc.data()
                    }));
                    samples.sort((a, b) => (b.timestamp?.seconds || 0) - (a.timestamp?.seconds || 0));
                    renderUI();
                });

                allProfileListeners.push(unsub);
            }
        };

        const renderUI = () => {
            const samplesContainer = document.getElementById('samples-container');
            const filterContainer = document.getElementById('filter-container');
            
            // ğŸš¨ é é˜²æ€§æª¢æŸ¥
            if (!samplesContainer || !filterContainer) return;
            
            const categories = getCategories();
            let categoryFiltered = currentCategoryFilter === 'å…¨éƒ¨' ? samples : samples.filter(s => s.category === currentCategoryFilter);
            const lowerTerm = searchTerm ? searchTerm.toLowerCase().trim() : '';
            const filteredSamples = lowerTerm ? categoryFiltered.filter(s => s.title.toLowerCase().includes(lowerTerm) || (s.content_ch && s.content_ch.toLowerCase().includes(lowerTerm)) || (s.content_en && s.content_en.toLowerCase().includes(lowerTerm))) : categoryFiltered;

            filterContainer.innerHTML = categories.map(cat => `
                <button 
                    onclick="window.app.setCategoryFilter('${cat}')"
                    class="px-4 py-2 text-sm font-semibold rounded-full transition duration-150 ${currentCategoryFilter === cat 
                        ? 'bg-indigo-600 text-white shadow-lg' 
                        : 'bg-white text-gray-700 hover:bg-indigo-100 border border-gray-300'}"
                >
                    ${cat} (${cat === 'å…¨éƒ¨' ? samples.length : samples.filter(s => s.category === cat).length})
                </button>
            `).join('') + `
                <button 
                    onclick="window.app.showAddCategoryModal()"
                    class="px-4 py-2 text-sm font-semibold rounded-full transition duration-150 bg-indigo-50 border border-indigo-300 text-indigo-700 hover:bg-indigo-200 flex items-center"
                >
                    <i data-lucide="plus" class="lucide-icon w-4 h-4 mr-1"></i>
                    æ–°å¢åˆ†é¡
                </button>
            `;

            if (filteredSamples.length === 0) {
                // åªæœ‰åœ¨æ¨£æœ¬ç‚ºç©ºæ™‚æ‰é¡¯ç¤ºåŠ è¼‰æç¤ºï¼Œå¦å‰‡æ‡‰è©²é¡¯ç¤ºã€Œæ­£åœ¨è¼‰å…¥æ‚¨çš„ä½œå“...ã€
                // å¦‚æœ samples ç‚ºç©ºï¼Œä½† userId å·²ç¶“è¨­ç½®ï¼Œå‰‡é¡¯ç¤ºå‰µå»ºæç¤º
                if (samples.length === 0 && userId) {
                     samplesContainer.innerHTML = `
                        <div class="col-span-full text-center py-10 bg-white rounded-xl shadow-inner text-gray-500">
                            <i data-lucide="book-open" class="lucide-icon w-12 h-12 mx-auto mb-4 text-gray-300"></i>
                            <p class="text-lg">ç›®å‰åœ¨é€™å€‹åˆ†é¡ä¸­æ²’æœ‰æ–‡å­—æ¨£æœ¬ã€‚</p>
                            <p class="text-sm">é»æ“Šå³ä¸Šè§’çš„ã€Œæ–°å¢æ–‡å­—æ¨£æœ¬ã€æŒ‰éˆ•é–‹å§‹å‰µå»ºå§ï¼</p>
                        </div>
                    `;
                } else if (!userId) {
                    // ğŸš¨ å¦‚æœç”¨æˆ¶ ID é‚„æ²’æ‹¿åˆ°ï¼Œä¿æŒåŸå§‹çš„åŠ è¼‰ä¸­ç‹€æ…‹
                    samplesContainer.innerHTML = `
                        <div class="col-span-full text-center py-10 text-gray-400">
                            <i data-lucide="loader" class="lucide-icon w-8 h-8 mx-auto mb-2 animate-spin"></i>
                            <p>æ­£åœ¨è¼‰å…¥æ‚¨çš„ä½œå“...</p>
                        </div>
                    `;
                } else {
                    // å·²ç¶“è¼‰å…¥éè³‡æ–™ï¼Œä½†åœ¨ç•¶å‰åˆ†é¡ä¸‹æ²’æœ‰æ¨£æœ¬
                     samplesContainer.innerHTML = `
                        <div class="col-span-full text-center py-10 bg-white rounded-xl shadow-inner text-gray-500">
                            <i data-lucide="folder-open" class="lucide-icon w-12 h-12 mx-auto mb-4 text-gray-300"></i>
                            <p class="text-lg">æ­¤åˆ†é¡ã€Œ${currentCategoryFilter}ã€ä¸­æ²’æœ‰ä»»ä½•æ¨£æœ¬ã€‚</p>
                            <p class="text-sm">è«‹åˆ‡æ›åˆ†é¡æˆ–æ–°å¢æ¨£æœ¬ã€‚</p>
                        </div>
                    `;
                }
            } else {
                samplesContainer.innerHTML = filteredSamples.map(renderSampleCard).join('');
            }
            
            lucide.createIcons();
        };

        // --- 10. å•Ÿå‹•æ‡‰ç”¨ç¨‹å¼ ---
        window.app = {
            switchUser: (name) => {
                if (name === currentProfileName) return;
                currentProfileName = name;
                localStorage.setItem('hkt_current_profile', name);
                renderUserTabs();
                listenForSamples();
            },

            addUser: () => {
                const name = prompt("è«‹è¼¸å…¥æ–°ç”¨æˆ¶åç¨±ï¼š");
                if (name && name.trim()) {
                    const clean = name.trim();
                    if (clean === 'æ‰€æœ‰æ–‡æœ¬') {
                        alert("æ­¤åç¨±ç‚ºç³»çµ±ä¿ç•™ï¼Œè«‹ä½¿ç”¨å…¶ä»–åç¨±");
                        return;
                    }
                    if (!profiles.includes(clean)) {
                        profiles.push(clean);
                        localStorage.setItem('hkt_profiles', JSON.stringify(profiles));
                        window.app.switchUser(clean);
                    } else {
                        alert("ç”¨æˆ¶å·²å­˜åœ¨");
                        window.app.switchUser(clean);
                    }
                }
            },

            
            copyText: (id, lang) => {
                const sample = samples.find(s => s.id === id);
                if(!sample) return;
                const text = lang === 'ch' ? sample.content_ch : sample.content_en;
                if(!text) return alert('è©²èªè¨€å…§å®¹ç‚ºç©º');
                navigator.clipboard.writeText(text).then(() => {
                    showModal('è¤‡è£½æˆåŠŸ', (lang==='ch'?'ä¸­æ–‡':'è‹±æ–‡') + 'å…§å®¹å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿', 'check');
                    setTimeout(() => window.app.hideModal(), 1500);
                });
            },

            setCategoryFilter,
            toggleEditMode,
            createNewSample,
            handleDeleteClick,
            hideConfirmModal,
            showAddSampleModal,
            hideAddSampleModal,
            showAddCategoryModal,
            hideAddCategoryModal,
            addNewCategoryAndFilter,
            hideModal, 
            saveSample,
            renderUI,
             
            
             
        };
        
        window.onload = () => {
            // æª¢æŸ¥ Firebase æ˜¯å¦æˆåŠŸåˆå§‹åŒ–
            if (auth && db) {
                signInAndListen();
            } else {
                console.warn("Firebase æœªæˆåŠŸåˆå§‹åŒ–ï¼Œè·³éèªè­‰æµç¨‹ã€‚");
            }
        };

    </script>
</head>
<body class="bg-gray-50 min-h-screen">

    
    
    
    
    <!-- è‡ªå®šç¾©è¨Šæ¯æ¨¡æ…‹æ¡† (Custom Modal) -->
    <div id="custom-modal" class="custom-modal fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 opacity-0 pointer-events-none">
        <div class="bg-white p-6 rounded-xl shadow-2xl max-w-sm w-full transform transition-all duration-300 scale-95" onclick="event.stopPropagation()">
            <div class="flex items-center mb-4">
                <span id="modal-icon-container"></span>
                <h3 id="modal-title" class="text-lg font-bold text-gray-800">è¨Šæ¯</h3>
                <button onclick="window.app.hideModal()" class="ml-auto text-gray-400 hover:text-gray-600">
                    <i data-lucide="x" class="lucide-icon w-5 h-5"></i>
                </button>
            </div>
            <p id="modal-message" class="text-gray-600 mb-4"></p>
            <div class="flex justify-end">
                <button onclick="window.app.hideModal()" class="px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition duration-150">ç¢ºå®š</button>
            </div>
        </div>
    </div>
    
    <!-- ç¢ºèªåˆªé™¤æ¨¡æ…‹æ¡† (Confirm Modal) -->
    <div id="confirm-modal" class="custom-modal fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 opacity-0 pointer-events-none">
        <div class="bg-white p-6 rounded-xl shadow-2xl max-w-sm w-full transform transition-all duration-300 scale-95" onclick="event.stopPropagation()">
            <div class="flex items-center mb-4">
                <i data-lucide="alert-triangle" class="lucide-icon text-red-500 w-6 h-6 mr-2"></i>
                <h3 class="text-lg font-bold text-gray-800">ç¢ºèªæ“ä½œ</h3>
            </div>
            <p id="confirm-message" class="text-gray-700 mb-6"></p>
            <div class="flex justify-end space-x-3">
                <button onclick="window.app.hideConfirmModal()" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition duration-150">å–æ¶ˆ</button>
                <button id="confirm-action-btn" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition duration-150">ç¢ºèªåˆªé™¤</button>
            </div>
        </div>
    </div>
    
    <!-- æ–°å¢æ¨£æœ¬æ¨¡æ…‹æ¡† (Add Sample Modal) -->
    <div id="add-sample-modal" class="custom-modal fixed inset-0 z-40 flex items-center justify-center bg-black bg-opacity-70 opacity-0 pointer-events-none" onclick="window.app.hideAddSampleModal()">
        <div class="bg-white p-6 rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto transform transition-all duration-300 modal-content-transition scale-90" onclick="event.stopPropagation()">
            <div class="flex justify-between items-center mb-4 border-b pb-3">
                <h2 class="text-2xl font-extrabold text-indigo-800 flex items-center">
                    <i data-lucide="pen-tool" class="lucide-icon w-6 h-6 mr-2"></i>
                    æ–°å¢æ–‡å­—æ¨£æœ¬
                </h2>
                <button onclick="window.app.hideAddSampleModal()" class="text-gray-400 hover:text-gray-600 p-1 rounded-full hover:bg-gray-100">
                    <i data-lucide="x" class="lucide-icon w-6 h-6"></i>
                </button>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="col-span-3 space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">æ¨™é¡Œ</label>
                        <input type="text" id="new-title" class="w-full border border-gray-300 p-3 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition shadow-sm" placeholder="ç‚ºé€™å€‹ä½œå“å–å€‹åå­—...">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">åˆ†é¡</label>
                        <select id="new-category" class="w-full border border-gray-300 p-3 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition shadow-sm bg-white">
                            <option value="æœªåˆ†é¡">æœªåˆ†é¡</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">ä¸­æ–‡å…§å®¹ (Chinese Content)</label>
                        <textarea id="new-content-ch" class="w-full h-64 border border-gray-300 p-3 rounded-lg resize-none focus:ring-indigo-500 focus:border-indigo-500 transition shadow-sm" placeholder="åœ¨é€™è£¡è¼¸å…¥æˆ–è²¼ä¸Šæ‚¨çš„æ–‡å­—å…§å®¹..."></textarea>
                    </div>
                    <div class="mt-4">
                        <label class="block text-sm font-medium text-gray-700 mb-1">è‹±æ–‡å…§å®¹ (English Content)</label>
                        <textarea id="new-content-en" class="w-full h-64 border border-gray-300 p-3 rounded-lg resize-none focus:ring-indigo-500 focus:border-indigo-500 transition shadow-sm" placeholder="Enter or paste your English text here..."></textarea>
                    </div>
                </div>
                
                </div>

            <div class="flex justify-end mt-6 pt-4 border-t border-gray-100 space-x-3">
                <button onclick="window.app.hideAddSampleModal()" class="px-5 py-2 bg-white border border-gray-300 text-gray-700 rounded-full hover:bg-gray-50 transition duration-150 font-medium">å–æ¶ˆ</button>
                <button onclick="window.app.createNewSample()" class="px-6 py-2 bg-indigo-600 text-white rounded-full hover:bg-indigo-700 transition duration-150 shadow-md flex items-center font-medium">
                    <i data-lucide="save" class="lucide-icon w-4 h-4 mr-2"></i>
                    å„²å­˜æ¨£æœ¬
                </button>
            </div>
        </div>
    </div>
    
    <!-- æ–°å¢åˆ†é¡æ¨¡æ…‹æ¡† -->
    <div id="add-category-modal" class="custom-modal fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 opacity-0 pointer-events-none">
        <div class="bg-white p-6 rounded-xl shadow-2xl max-w-sm w-full transform transition-all duration-300 scale-95" onclick="event.stopPropagation()">
             <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold text-gray-800">æ–°å¢åˆ†é¡</h3>
                <button onclick="window.app.hideAddCategoryModal()" class="text-gray-400 hover:text-gray-600">
                    <i data-lucide="x" class="lucide-icon w-5 h-5"></i>
                </button>
            </div>
            <p class="text-sm text-gray-600 mb-4">è«‹è¼¸å…¥æ–°åˆ†é¡çš„åç¨±ï¼š</p>
            <input type="text" id="new-category-name" class="w-full border border-gray-300 p-2 rounded-lg mb-4 focus:ring-indigo-500 focus:border-indigo-500" placeholder="ä¾‹å¦‚ï¼šæœƒè­°è¨˜éŒ„">
            <div class="flex justify-end space-x-2">
                <button onclick="window.app.hideAddCategoryModal()" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition duration-150">å–æ¶ˆ</button>
                <button onclick="window.app.addNewCategoryAndFilter()" class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition duration-150">æ–°å¢ä¸¦åˆ‡æ›</button>
            </div>
        </div>
    </div>

    <div id="app-container" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Header Section -->
        <div class="bg-white rounded-2xl shadow-xl p-6 mb-8 border-l-8 border-indigo-600 flex flex-col md:flex-row justify-between items-center relative overflow-hidden">
             <!-- èƒŒæ™¯è£é£¾ -->
            <div class="absolute top-0 right-0 -mt-10 -mr-10 w-40 h-40 bg-indigo-50 rounded-full opacity-50 pointer-events-none"></div>
            
            <div class="z-10">
                <h1 class="text-3xl md:text-4xl font-extrabold text-gray-900 tracking-tight mb-2 flex items-center">
                    KIWI QUICK TEXT
                    
                </h1>
                <p class="text-indigo-600 font-medium text-lg">åœ¨é€™è£¡ç®¡ç†å’Œä¿®æ”¹æ‚¨çš„æ–‡å­—ä½œå“é›†ã€‚</p>
                
                
                <div class="mb-4">
                    <div id="user-tabs-container" class="inline-flex flex-wrap items-center gap-2">
                         <span class="text-sm text-gray-400">è¼‰å…¥ç”¨æˆ¶ä¸­...</span>
                    </div>
                </div>
                <div id="auth-status" class="mt-3 flex items-center space-x-2">
                    <i data-lucide="loader" class="lucide-icon w-4 h-4 animate-spin text-indigo-500"></i>
                    <span class="text-sm text-gray-500">æ­£åœ¨é€£æ¥è³‡æ–™åº«...</span>
                </div>
            </div>
            
            <div class="mt-4 md:mt-0 z-10">
                <button onclick="window.app.showAddSampleModal()" class="group bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-200 flex items-center transform hover:-translate-y-1">
                    <div class="bg-white bg-opacity-20 rounded-full p-1 mr-3 group-hover:rotate-90 transition duration-300">
                        <i data-lucide="plus" class="lucide-icon w-5 h-5"></i>
                    </div>
                    <span class="font-bold">æ–°å¢æ–‡å­—æ¨£æœ¬</span>
                </button>
            </div>
        </div>

        <!-- Filter & Search Section -->
        <div class="bg-white rounded-xl shadow-md p-4 mb-8 sticky top-4 z-30 bg-opacity-95 backdrop-blur-sm border border-gray-100">
            <div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
                <div class="flex items-center w-full md:w-auto overflow-x-auto pb-2 md:pb-0 no-scrollbar mask-linear-fade">
                    <span class="text-sm font-bold text-gray-500 mr-3 uppercase tracking-wider flex-shrink-0">åˆ†é¡ç¯©é¸</span>
                    <div id="filter-container" class="flex space-x-2">
                        <!-- Filters injected by JS -->
                        <span class="text-gray-400 text-sm italic">è¼‰å…¥åˆ†é¡ä¸­...</span>
                    </div>
                </div>
                
                <div class="relative w-full md:w-64 group">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <i data-lucide="search" class="lucide-icon text-gray-400 group-focus-within:text-indigo-500 transition"></i>
                    </div>
                    <input type="text" class="block w-full pl-10 pr-3 py-2 border border-gray-200 rounded-full leading-5 bg-gray-50 placeholder-gray-400 focus:outline-none focus:bg-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition duration-150 sm:text-sm" id="search-input" placeholder="æœå°‹æ¨£æœ¬æ¨™é¡Œ...">
                </div>
            </div>
        </div>

        <!-- Content Grid -->
        <div id="samples-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 pb-10">
            <!-- Sample Cards injected by JS -->
            <div class="col-span-full flex flex-col items-center justify-center py-20 text-gray-400 opacity-70">
                <i data-lucide="loader" class="lucide-icon w-10 h-10 mb-3 animate-spin text-indigo-300"></i>
                <p>æ­£åœ¨è¼‰å…¥æ‚¨çš„ä½œå“...</p>
            </div>
        </div>
    </div>

</body>
</html>
